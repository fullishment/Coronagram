<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminUser">

<!-- list -->
	<select id="getadminUserList" parameterType="hashmap" resultType="hashmap">
		SELECT M.M_NO, M.M_ID, M.M_NM, M.PHONE, M.EMAIL, M.M_DT, M.POINT, M.ACCT_TYPE_NO
		FROM (	SELECT M_NO, M_ID, M_NM, PHONE, EMAIL,
				TO_CHAR(M_DT,'yyyy-mm-dd') AS M_DT, POINT, ACCT_TYPE_NO,
				ROW_NUMBER() OVER(ORDER BY M_NO DESC) AS RNUM
			FROM M
			WHERE DEL = 1
			<if test="searchTxt != null and searchTxt != ''">
				<choose>
					<when test="searchGbn eq 0">
						AND M_NO LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 1">
						AND M_ID LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 2">
						AND M_NM LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 3">
						AND PHONE LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 4">
						AND EMAIL LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 5">
						AND M_DT LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 6">
						AND POINT LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 7">
						AND ACCT_TYPE_NO LIKE '%' || #{searchTxt} || '%'
					</when>
				</choose>
			</if>
		) M
		WHERE M.RNUM BETWEEN #{startCnt} AND #{endCnt}
	</select>
	
<!-- paging -->
	<select id="getadminUserCnt" parameterType="hashmap" resultType="Integer">
		SELECT COUNT(*) AS CNT
		FROM M
		WHERE DEL = 1
		<if test="searchTxt != null and searchTxt != ''">
		 	<choose>
		 		<when test="searchGbn eq 0">
						AND M_NO LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 1">
						AND M_ID LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 2">
						AND M_NM LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 3">
						AND PHONE LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 4">
						AND EMAIL LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 5">
						AND M_DT LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 6">
						AND POINT LIKE '%' || #{searchTxt} || '%'
					</when>
					<when test="searchGbn eq 7">
						AND ACCT_TYPE_NO LIKE '%' || #{searchTxt} || '%'
					</when>
		 	</choose>
		</if>
	</select>
	
<!-- dtl -->
	<select id="getAProfile" parameterType="hashmap" resultType="hashmap">
		SELECT M_NO, M_ID, M_NM, NICK_NM, PHONE, EMAIL, VAC_YN, POST_NO, ADR, DTL_ADR, 
				ACCT_TYPE_NO, POINT
    	FROM M
		WHERE M_NO = #{no}
	</select>
	
</mapper>